---
title: "Arbeidskrav våren 2022"
subtitle: "MSB106, Anvendt by- og regionaløkonomi"
author:
- Kevin Ha
- Ola Andre Olofsson
- Ann Elisabeth Jacobsen
- Heidi Marie Rolfsnes
output:
  pdf_document: default
  html_notebook: default
lang: no-NB
---

```{r setup, include=FALSE}
suppressPackageStartupMessages({
library(readr)
library(ggplot2)
library(knitr)
library(viridis)
library(tidyverse)
})
knitr::opts_chunk$set(echo=FALSE, include = FALSE)
```

# Innlesing av .csv filer

```{r csv_filer}
syssel_arb <- read_csv("Data/syssel_arb.csv", show_col_types = FALSE)
hld_arb <- read_csv("Data/hld_arb.csv", show_col_types = FALSE)
sun_arb <- read_csv("Data/sun_arb.csv", show_col_types = FALSE)
har_arb <- read_csv("Data/har_arb.csv", show_col_types = FALSE)
syssel_bos <- read_csv("Data/syssel_bos.csv", show_col_types = FALSE)
hld_bos <- read_csv("Data/hld_bos.csv", show_col_types = FALSE)
sun_bos <- read_csv("Data/sun_bos.csv", show_col_types = FALSE)
har_bos <- read_csv("Data/har_bos.csv", show_col_types = FALSE)
```

# 1.

```{r}
hld_arb %>% 
  ggplot(mapping = aes(x = År, y = Totalt)) +
  geom_line() +
  labs(title = "Haugalandet")+
  ylab("Antall ansatte i  \n alle næringer") +
  theme(axis.title.y = element_text(angle=0))+
  scale_x_continuous(breaks = seq(2008, 2020, by = 1))
```


```{r ggplot_For_Arbeidssted_Haugalandet}
syssel_arb %>% 
  filter(knr %in% c(1106, 1135, 1145, 1146, 1149, 1151, 1160)) %>% 
  ggplot(mapping = aes(x = as.Date(paste0(aar, "-01-01")), y = `Alle Næringer`, (angle=0))) +
  scale_color_viridis(discrete = TRUE, option = "A") +
  geom_line(aes(group = knavn, colour = knavn)) +
  scale_size_manual(values = c(seq(2.0, 2, by = -0.1))) +
  geom_hline(yintercept = 0) +
  labs(title = "Haugalandet", x = "År", y = "Antall ansatte i  \n alle næringer") +
  theme(axis.title.y = element_text(angle=0))+
  theme(legend.position = 'bottom')
```
```{r}
hld_arb_long <- syssel_arb %>%
  pivot_longer(
    cols = `Jordbruk, Skogbrug og Fiske`:Uoppgitt,
    names_to = "Næring",
    values_to = "Ansatte"
  )
```

```{r Næringsfordeling- og utvikling i Haugelandet}

# Kevin: Hei! Vurderer om denne må gjøres på både Sunnhordland, samt Hardanger.

hld_arb_long %>% 
  # Vi ønsker å studere alle kommunene som formelt sett regnes som Haugalandet
  filter(knavn %in% c("Bokn", "Haugesund", "Karmøy", "Sauda", "Tysvær", "Utsira", "Vindafjord")) %>% 
  
  # Vi omformaterer datoene til mer formålstjenlige format
  ggplot(mapping = aes(x = as.Date(paste0(aar, "-01-01")), y = Ansatte)) +
  
  # Vi velger hvilken fargeoppslagstabell som skal anvendes
  scale_color_viridis(discrete = TRUE, option = "A") +
  # Angir aksetitler
  labs(x = "År", y = "Antall ansatte") +
  # Angir hvilke variabler fargene skal basere seg på
  geom_line(mapping = aes(group = Næring, colour = Næring)) +
  
  # Lager et panel som viser flere grafer, fordelt på tre kolonner
  facet_wrap(facets = ~ knavn, scales = "free_y", ncol = 3) +
  
  # Bestemmer at forklaringene skal stå på høyre side
  theme(legend.position = 'right')
```

```{r Haugesund}
syssel_arb %>%
  filter(knr == 1106) %>%
 ggplot(mapping = aes(x = aar, y = `Alle Næringer`)) +
  geom_line() +
  labs(title = "Haugesund", x = "År", y = "Antall ansatte i  \n alle næringer") +
  theme(axis.title.y = element_text(angle=0))+
  scale_x_continuous(breaks = seq(2008, 2020, by = 1)) +
  coord_cartesian(ylim = c(20852, 22190), xlim = c())
```

```{r Sauda}
syssel_arb %>%
  filter(knr == 1135) %>%
 ggplot(mapping = aes(x = aar, y = `Alle Næringer`)) +
  geom_line() +
  labs(title = "Sauda", x = "År", y = "Antall ansatte i  \n alle næringer") +
  theme(axis.title.y = element_text(angle=0))+
  scale_x_continuous(breaks = seq(2008, 2020, by = 1)) +
  coord_cartesian(ylim = c(1937, 2180), xlim = c())
```

```{r Bokn}
syssel_arb %>%
  filter(knr == 1145) %>%
 ggplot(mapping = aes(x = aar, y = `Alle Næringer`)) +
  geom_line() +
  labs(title = "Bokn", x = "År", y = "Antall ansatte i  \n alle næringer") +
  theme(axis.title.y = element_text(angle=0))+ 
  scale_x_continuous(breaks = seq(2008, 2020, by = 1)) +
  coord_cartesian(ylim = c(291, 327), xlim = c())
```

```{r Tysvær}
syssel_arb %>%
  filter(knr == 1146) %>%
 ggplot(mapping = aes(x = aar, y = `Alle Næringer`)) +
  geom_line() +
  labs(title = "Tysvær", x = "År", y = "Antall ansatte i  \n alle næringer") +
  theme(axis.title.y = element_text(angle=0))+ 
  scale_x_continuous(breaks = seq(2008, 2020, by = 1)) +
  coord_cartesian(ylim = c(4048, 4773), xlim = c())
```

```{r Karmøy}
syssel_arb %>%
  filter(knr == 1149) %>%
 ggplot(mapping = aes(x = aar, y = `Alle Næringer`)) +
  geom_line() +
  labs(title = "Karmøy", x = "År", y = "Antall ansatte i  \n alle næringer") +
  theme(axis.title.y = element_text(angle=0))+ 
  scale_x_continuous(breaks = seq(2008, 2020, by = 1)) +
  coord_cartesian(ylim = c(14591, 16059), xlim = c())
```

```{r Utsira}
syssel_arb %>%
  filter(knr == 1151) %>%
 ggplot(mapping = aes(x = aar, y = `Alle Næringer`)) +
  geom_line() +
  labs(title = "Utsira", x = "År", y = "Antall ansatte i  \n alle næringer") +
  theme(axis.title.y = element_text(angle=0))+ 
  scale_x_continuous(breaks = seq(2008, 2020, by = 1)) +
  coord_cartesian(ylim = c(88, 114), xlim = c())
```

```{r Vindafjord}
syssel_arb %>%
  filter(knr == 1160) %>%
 ggplot(mapping = aes(x = aar, y = `Alle Næringer`)) +
  geom_line() +
  labs(title = "Vindafjord", x = "År", y = "Antall ansatte i  \n alle næringer") +
  theme(axis.title.y = element_text(angle=0))+ 
  scale_x_continuous(breaks = seq(2008, 2020, by = 1)) +
  coord_cartesian(ylim = c(4422, 5037), xlim = c())
```

Så gjer vi det samme for *Sunnhordland*

```{r}
sun_arb %>% 
  ggplot(mapping = aes(x = År, y = Totalt)) +
  geom_line() +
  labs(title = "Sunnhordaland", x = "År", y = "Antall ansatte i  \n alle næringer") +
  theme(axis.title.y = element_text(angle=0))+ 
  scale_x_continuous(breaks = seq(2008, 2020, by = 1))
```


```{r ggplot_For_Arbeidssted_Sunnhordland}
syssel_arb %>% 
  filter(knr %in% c(4611, 4612, 4613, 4614, 4615, 4616, 4617)) %>% 
  ggplot(mapping = aes(x = aar, y = `Alle Næringer`)) +
  scale_color_viridis(discrete = TRUE, option = "A") +
  geom_line(aes(group = knavn, colour = knavn)) +
  scale_size_manual(values = c(seq(2.0, 2, by = -0.1))) +
  geom_hline(yintercept = 0) +
  scale_x_continuous(breaks = seq(2008, 2020, by = 1)) +
   labs(title = "Sunnhordland", x = "År") +
  theme(legend.position = 'bottom')
```


```{r Etne}
syssel_arb %>%
  filter(knr == 4611) %>%
 ggplot(mapping = aes(x = aar, y = `Alle Næringer`)) +
  geom_line() +
  labs(title = "Etne", x = "År") + 
  scale_x_continuous(breaks = seq(2008, 2020, by = 1)) +
  coord_cartesian(ylim = c(1613, 1775), xlim = c())
```

```{r Sveio}
syssel_arb %>%
  filter(knr == 4612) %>%
 ggplot(mapping = aes(x = aar, y = `Alle Næringer`)) +
  geom_line() +
  labs(title = "Sveio", x = "År") + 
  scale_x_continuous(breaks = seq(2008, 2020, by = 1)) +
  coord_cartesian(ylim = c(1357, 1523), xlim = c())
```

```{r Bømlo}
syssel_arb %>%
  filter(knr == 4613) %>%
 ggplot(mapping = aes(x = aar, y = `Alle Næringer`)) +
  geom_line() +
  labs(title = "Bømlo", x = "År") + 
  scale_x_continuous(breaks = seq(2008, 2020, by = 1)) +
  coord_cartesian(ylim = c(4662, 4890), xlim = c())
```

```{r Stord}
syssel_arb %>%
  filter(knr == 4614) %>%
 ggplot(mapping = aes(x = aar, y = `Alle Næringer`)) +
  geom_line() +
  labs(title = "Stord", x = "År") + 
  scale_x_continuous(breaks = seq(2008, 2020, by = 1)) +
  coord_cartesian(ylim = c(9161, 9938), xlim = c())
```

```{r Fitjar}
syssel_arb %>%
  filter(knr == 4615) %>%
 ggplot(mapping = aes(x = aar, y = `Alle Næringer`)) +
  geom_line() +
  labs(title = "Fitjar", x = "År") + 
  scale_x_continuous(breaks = seq(2008, 2020, by = 1)) +
  coord_cartesian(ylim = c(1085, 1259), xlim = c())
```

```{r Tysnes}
syssel_arb %>%
  filter(knr == 4616) %>%
 ggplot(mapping = aes(x = aar, y = `Alle Næringer`)) +
  geom_line() +
  labs(title = "Tysnes", x = "År") + 
  scale_x_continuous(breaks = seq(2008, 2020, by = 1)) +
  coord_cartesian(ylim = c(989, 1188), xlim = c())
```

```{r Kvinnherad}
syssel_arb %>%
  filter(knr == 4617) %>%
 ggplot(mapping = aes(x = aar, y = `Alle Næringer`)) +
  geom_line() +
  labs(title = "Kvinnherad", x = "År") + 
  scale_x_continuous(breaks = seq(2008, 2020, by = 1)) +
  coord_cartesian(ylim = c(5472, 6084), xlim = c())
```

Til slutt må vi gjere det samme med *Hardanger*

```{r}
har_arb %>% 
  ggplot(mapping = aes(x = År, y = Totalt)) +
  geom_line() +
  labs(title = "Hardanger", y= "Alle Næringer") + 
  scale_x_continuous(breaks = seq(2008, 2020, by = 1))
```


```{r ggplot_For_Arbeidssted_Hardanger}
syssel_arb %>% 
  filter(knr %in% c(4618, 1228)) %>% 
  ggplot(mapping = aes(x = aar, y = `Alle Næringer`)) +
  scale_color_viridis(discrete = TRUE, option = "A") +
  geom_line(aes(group = knavn, colour = knavn)) +
  scale_color_manual(values=c('#111111','#054987')) +
  scale_size_manual(values = c(seq(2.0, 2, by = -0.1))) +
  geom_hline(yintercept = 0) +
  scale_x_continuous(breaks = seq(2008, 2020, by = 1)) +
   labs(title = "Hardanger", x = "År") +
  theme(legend.position = 'bottom')
```

```{r Odda}
syssel_arb %>%
  filter(knr == 1228) %>%
 ggplot(mapping = aes(x = aar, y = `Alle Næringer`)) +
  geom_line() +
  labs(title = "Odda", x = "År") + 
  scale_x_continuous(breaks = seq(2008, 2020, by = 1)) +
  coord_cartesian(ylim = c(3489, 3740), xlim = c())
```

```{r Ullensvang}
syssel_arb %>%
  filter(knr == 4618) %>%
 ggplot(mapping = aes(x = aar, y = `Alle Næringer`)) +
  geom_line() +
  labs(title = "Ullensvang", x = "År") + 
  scale_x_continuous(breaks = seq(2008, 2020, by = 1)) +
  coord_cartesian(ylim = c(1235, 5291), xlim = c())
```


-
```{r siste}
# Siste
```

-
